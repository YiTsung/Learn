"use strict";(self["webpackChunkwork"]=self["webpackChunkwork"]||[]).push([[677],{5946:function(t,i){i.Z={inject:["emitter"],methods:{getCarts(){this.isLoading=!0;const t="https://vue3-course-api.hexschool.io/api/zyt-api/cart";this.$http.get(t).then((t=>{t.data.success&&(this.isLoading=!1,this.cartLength=t.data.data.carts.length,this.emitter.emit("push-CartNotice",{data:this.cartLength}))}))}}}},3881:function(t,i){i.Z={methods:{getFavorite(){if(localStorage.getItem("favoriteItem")){const t=localStorage.getItem("favoriteItem");this.idList=JSON.parse(t),this.favoriteLength=this.idList.length}else this.idList=[],this.favoriteLength=0;this.emitter.emit("push-FavNotice",{data:this.favoriteLength})}}}},6677:function(t,i,e){e.r(i),e.d(i,{default:function(){return T}});var s=e(3396),a=e(7139),o=e(9242);const r={class:"container mt-5"},c={class:"row g-3"},d={class:"side-bar col-lg-2"},l={class:"text-center d-flex flex-md-column justify-content-center"},n=["onClick"],u={class:"col-lg-10 row ms-0"},h={class:"card mt-1 mb-2 mx-auto"},g=["onClick"],p={class:"overflow-hidden text-light position-relative border-bottom card-pic"},m={class:"position-absolute bg-secondary px-2 bottom-0 end-0 rounded m-1"},v={class:"card-text"},f=["src","alt"],y={class:"card-body text-dark"},w={class:"row overflow-hidden"},L={class:"card-title col-10 overflow-hidden"},b={class:"mw-25 text-end col-2 add-favorite"},k=["onClick"],_={key:0,class:"bi bi-heart text-danger",title:"加入收藏"},x={key:1,class:"bi bi-heart-fill text-danger",title:"移除收藏"},C={class:"card-text card-price"},I={key:0,class:"text-decoration-line-through fs-6"},P={class:"fs-5"},D={class:"card-footer"},z=["onClick"],$={key:0,class:"spinner-border text-light spinner-border-sm",role:"status"},N=(0,s._)("span",{class:"visually-hidden"},"Loading...",-1),S=[N],F={key:1,class:"bi bi-cart-plus"};function O(t,i,e,N,O,Z){const j=(0,s.up)("Loading");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(j,{active:O.isLoading},null,8,["active"]),(0,s._)("div",r,[(0,s._)("div",c,[(0,s._)("div",d,[(0,s._)("div",l,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(O.categoryList,(t=>((0,s.wg)(),(0,s.iD)("button",{key:t.value,class:(0,a.C_)(["btn btn-outline-success me-1 me-md-0 mb-md-1 py-md-2 text-nowrap",{active:t.value===this.currentCategory}]),type:"button",onClick:i=>Z.filterProducts(t.value)},(0,a.zw)(t.value),11,n)))),128))])]),(0,s._)("div",u,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(O.tempProduct,(i=>((0,s.wg)(),(0,s.iD)("div",{class:"col-sm-12 col-md-6 col-lg-4",key:i.id},[(0,s._)("div",h,[(0,s._)("a",{href:"#",onClick:(0,o.iM)((t=>Z.getProduct(i.id)),["prevent"])},[(0,s._)("div",p,[(0,s._)("div",m,[(0,s._)("p",v,(0,a.zw)(i.category),1)]),(0,s._)("img",{src:i.imageUrl,alt:i.title,class:"card-img-top d-block align-middle w-100 w-auto mx-auto"},null,8,f)]),(0,s._)("div",y,[(0,s._)("div",null,[(0,s._)("h3",w,[(0,s._)("div",L,(0,a.zw)(i.title),1),(0,s._)("div",b,[(0,s._)("a",{href:"#",onClick:(0,o.iM)((t=>Z.updateFavorite(i)),["stop","prevent"])},[O.idList.every((t=>i.id!==t))?((0,s.wg)(),(0,s.iD)("i",_)):((0,s.wg)(),(0,s.iD)("i",x)),(0,s.Uk)((0,a.zw)(null))],8,k)])])]),(0,s._)("p",C,[i.origin_price!==i.price?((0,s.wg)(),(0,s.iD)("span",I," NT$"+(0,a.zw)(t.$filters.currency(i.origin_price)),1)):(0,s.kq)("",!0),(0,s._)("span",P," NT$"+(0,a.zw)(t.$filters.currency(i.price)),1)])])],8,g),(0,s._)("div",D,[(0,s._)("button",{type:"button",class:"btn button-light-color w-100",onClick:(0,o.iM)((t=>Z.addCart(i.id)),["prevent"])},[this.status.loadingItem===i.id?((0,s.wg)(),(0,s.iD)("div",$,S)):((0,s.wg)(),(0,s.iD)("i",F)),(0,s.Uk)("加入購物車 ")],8,z)])])])))),128))])])])],64)}e(7658);var Z=e(5946),j=e(3881),H={inject:["emitter"],mixins:[Z.Z,j.Z],data(){return{idList:[],products:[],tempProduct:{},isLoading:!1,currentCategory:"全部",status:{loadingItem:""},categoryList:[{value:"全部"},{value:"桌花"},{value:"永生花束"},{value:"花藝燈"}]}},methods:{getProducts(){this.isLoading=!0;const t="https://vue3-course-api.hexschool.io/api/zyt-api/products/all";this.$http.get(t).then((t=>{this.isLoading=!1,t.data.success&&(this.products=t.data.products,this.tempProduct=this.products)}))},getProduct(t){this.$router.push(`/products/${t}`)},updateFavorite(t){this.idList.every((i=>t.id!==i))?(this.idList.push(t.id),localStorage.setItem("favoriteItem",JSON.stringify(this.idList)),this.emitter.emit("push-message",{style:"success",title:"已新增至收藏"})):(this.idList.indexOf(t.id),this.idList.splice(this.idList.indexOf(t.id),1),localStorage.setItem("favoriteItem",JSON.stringify(this.idList)),this.emitter.emit("push-message",{style:"danger",title:"已取消收藏"})),this.getFavorite()},addCart(t){this.status.loadingItem=t;const i={product_id:t,qty:1},e="https://vue3-course-api.hexschool.io/api/zyt-api/cart";this.$http.post(e,{data:i}).then((t=>{this.status.loadingItem="",this.getCarts(),this.emitter.emit("push-message",{style:"success",title:"已加入購物車"})}))},filterProducts(t){this.isLoading=!0,this.currentCategory=t,setTimeout((()=>{"全部"===t?(this.tempProduct=this.products,this.isLoading=!1):(this.tempProduct=this.products.filter((i=>i.category===t)),this.isLoading=!1)}),1e3)}},created(){this.getProducts(),this.getFavorite()}},J=e(89);const M=(0,J.Z)(H,[["render",O]]);var T=M}}]);
//# sourceMappingURL=677.2da4a746.js.map